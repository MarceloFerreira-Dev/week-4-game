<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
    <title>Trigger Random</title>
       <!-- Added link to the jQuery Library -->
       <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
       <!-- Added a link to Bootstrap-->
       
       <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"/>
  <style>
  .jumbotron  {
               display: flex;
               justify-content: center;
               align-items: center;
              }
  </style>
</head>
<body>
  <div class="jumbotron" display="flex" justify-content="center" align-items="center">
    <img src="./img/logo.png" alt="Banner" class="img-responsive">
    <h1 class="text-center"></h1>
        <div class="text-center">
      <!-- Here we have our button for start the game (#Start-button) -->
      <button id="Start-button" class="btn btn-primary btn-lg"><h1><span class="glyphicon glyphicon-play-circle"></span> Play!</h1></button>
    </div>
  </div>
  <div id="arena" class="container">
    <div class="row">
      <div class="col-sm-4">
      <!-- Set Hangman stage. -->  
        <img id="Hang-img" src="./img/hang.png" alt="Hang" width="300" height="420">  
      </div>
      <div class="col-sm-4">
        <div id="display"></div>
          <div id="buttons"></div>
          <div id="Guesses">
        </div>
      </div>
      <div class="col-sm-4">
        <button class="button-center" id="wordgen">>>>>First click here to generate a word!<<<<<</button>
        <h1 id="word" class="text-center">Word</h1>
        <h2 class="text-center"></h2>
      </div>
    </div>
  </div>
  <audio id="myAudio" autoplay controls>
    <source src="./Theme/KIT.mp3" type="audio/mpeg">
  </audio>
  <!-- Here we have div called "random-number" where our random number will go -->
  <h1 class="text-center" id="random-number"></h1>
  <script type="text/javascript">

  $("#arena").hide();
   var count = 1;
   var api = 'https://api.wordnik.com/v4/words.json/randomWord';
   var key = 'a2a73e7b926c924fad7001ca3111acd55af2ffabf50eb4ae5';
   var mySound;       // Audio variable
   var corpus = 1000; // higher = less complex words
   var def = true;    // only words with definitions ?
   var x = document.getElementById("myAudio"); 
   var word;          // Variable Word from API.
   var wronguess = 0;   // Variable for counting bad guesses

function getWord(type, c) {
    return $.get(
        api + 
        '?includePartOfSpeech=' + type +
        '&hasDictionaryDef=' + def +
        '&minCorpusCount=' + corpus + 
        '&api_key=' + key
    );    
}
function link(res) {
    var w = res[0].word;
    var upper = w.charAt(0).toUpperCase() + w.slice(1); 
    return '<a target = "_blank" href="https://www.wordnik.com/words/' 
        + w.toLowerCase() + '">' + upper + '</a>';
}
// Body background.
    document.body.style.backgroundColor = "rgb(0, 153, 153)";      
// Generates a new word
    $("#wordgen").on("click", function() {
// Creates an empty array which will be filled with underscore char and one space char "_ ".
      var wordArray = [];
// Get a random word from wordnick API.
    $.when(getWord('noun'), getWord('adjective'), getWord('noun'))
    .then(function(a, b, c) {
        var sentence = 
            link(a) + ' <small>of the</small> ' + 
            link(b) + ' ' + link(c);
         //$('h2').html(sentence);
         // random word string generated by wordnick API.
         word = a[0].word;
         // Console log for debbuging purposes.
         console.log(word);
         console.log(word.length);
         // push underscore char and space char "_ " into wordArray.
      for (i = 0; i < word.length; i++){
         wordArray.push("_ ");
     };
         console.log(wordArray);
         // Show underscore array with the length of random word generated by wornick API.
         $('h2').html(wordArray);
    })
    .fail(function() { alert('ERROR'); });
    // Letter selection function.
    $(".letter-button").on("click", function() {  
           // Show  wordArray with with underscore chars and correct guesses letters in the rigth position.
           $('h2').html(wordArray);
           // Pointer variable for n char location in the word string.
           var pos = 0;
           // Upper case letter selected by clicking $(".letter-button").on("click", function().
           var wordPick = ($(this).attr("data-letter"));
           // Convert wordPick variable to lower case and store on letters variable. 
           var letters = wordPick.toLowerCase();
           // Variable for maximum mistakes to determinate end of game.
           var maxmistakes = 6;
           // Console log for debbuging purposes.
           console.log(word);
           console.log(wordPick);
           // position of n char stored on letters inside of word string.
           pos = word.indexOf(letters);
           // Console log for debbuging purposes.           
           console.log(pos);
           // alert("postion "+ pos);
            // if pos = -1 due to word.indexOf(letters) meaning n letter doesn't occur inside word string.
            if(pos == -1){ 
                  

                  // counts up wrong guess.         
                  wronguess = wronguess + 1;
                  console.log("wrong guess "+wronguess);

                  // Show image associated with n wronguess guess.
                  document.getElementById("Hang-img").src = "./img/hang"+ wronguess +".png";
                  // Show number of wrong guesses.
                  $("#Guesses").html("<h3>Wrong Guesses: " + wronguess+"</h3>");
                  // Compares number of wrong guesses with max mistakes. If true game over.

                 if(wronguess === maxmistakes){
                    // Show game over picture.
                    document.getElementById("Hang-img").src = "./img/hang"+ 6 +".png";
                    // set variable wronguess to zero.
                    wronguess = 0;
                    // Set myDelay variable to call function mytimer after 2 seconds and reload the page.
                    var myDelay = setInterval(myTimer, 2000);
                    function myTimer() {
                      location.reload();  
                    }
                  };


            }else {
              // Loop to fill wordArray with right n letter guessed.
              for(i = 0; i < word.length; i++){
              // Verify more than one occurence of n letter inside word string from i position.
               pos = word.indexOf(letters,i);
               // Put n letter guessed inside wordArray on the same index that occurs in word variable.
               wordArray[pos] = letters;
               // Condition to exit the loop if there is no occurence of n letter inside word string.
                 if(pos == -1){
                    break;
                 };
                };
                // Show wordArray on HTML h2 tag.
                $('h2').html(wordArray);               
              };
           // Console log for debbuging purposes.           
               console.log(wordArray);                         
               console.log(letters,pos,word);           
      });  
    });

    // On click function to start the game.
    $("#Start-button").on("click", function() { 
        // show button part of  the page.
        $("#arena").slideDown(2000);   
        // Show picture of Hangman stage.  
        document.getElementById("Hang-img").src = "./img/hang.png";
        $(document).ready(function() {
        // Array for the keyboard buttons.
        var letters = ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z", "_"];
        // DYNAMICALLY CREATE BUTTONS
        // 1. Create a for-loop to iterate through the letters array.
      for (var i = 0; i < letters.length; i++) {
        // Inside the loop...
        // Create a variable named "letterBtn" equal to $("<button>");
        var letterBtn = $("<button>");
        // Give each "letterBtn" the following classes: "letter-button" "letter" "letter-button-color".
        letterBtn.addClass("letter-button letter letter-button-color");
        // Give each "letterBtn" a data-attribute called "data-letter".
        letterBtn.attr("data-letter", letters[i]);
        // Give each "letterBtns" a text equal to "letters[i]".
        letterBtn.text(letters[i]);
        // Append each "letterBtn" to the "'buttons" div (provided).
        $("#buttons").append(letterBtn);
      };  
     });
    });
  </script>
</body>
</html>
